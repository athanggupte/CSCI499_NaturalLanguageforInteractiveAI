2022-11-17:13:16:24 INFO     [log.py:62] Logger configured successfully
2022-11-17:13:16:24 INFO     [train.py:386] Args:
	in_data_fn = lang_to_sem_data.json
	model_output_dir = models
	batch_size = 512
	force_cpu = False
	eval = False
	num_epochs = 26
	val_every = 5
	vocab_size = 1000
	emb_dim = 100
	hidden_dim = 100
	learning_rate = 0.1
	student_forcing = False
	model_type = lstm
2022-11-17:13:16:25 INFO     [utils.py:109] Train #episodes: 70285
2022-11-17:13:16:25 INFO     [utils.py:110] Val #episodes: 2838
2022-11-17:13:16:30 INFO     [utils.py:163] Total instances: 70285
2022-11-17:13:16:30 INFO     [utils.py:166] UNK tokens : 6333 / 5365812 (0.0012)     (vocab_size = 1000)
2022-11-17:13:16:30 INFO     [utils.py:170] Cut off 0 instances at len 0 before true ending
2022-11-17:13:16:30 INFO     [utils.py:174] encoded 70285 instances without regard to order
2022-11-17:13:16:30 INFO     [utils.py:163] Total instances: 2838
2022-11-17:13:16:30 INFO     [utils.py:166] UNK tokens : 317 / 223108 (0.0014)     (vocab_size = 1000)
2022-11-17:13:16:30 INFO     [utils.py:170] Cut off 0 instances at len 0 before true ending
2022-11-17:13:16:30 INFO     [utils.py:174] encoded 2838 instances without regard to order
2022-11-17:13:16:31 INFO     [train.py:337] EncoderDecoder(
  (encoder): Encoder(
    (embedding): Embedding(1000, 100, padding_idx=0)
    (lstm): LSTM(100, 100, batch_first=True)
  )
  (decoder): Decoder(
    (action_embedding): Embedding(11, 100, padding_idx=0)
    (target_embedding): Embedding(83, 100, padding_idx=0)
    (lstm): LSTM(200, 100, batch_first=True)
  )
  (fc_a): Linear(in_features=100, out_features=11, bias=True)
  (fc_t): Linear(in_features=100, out_features=83, bias=True)
)
2022-11-17:13:16:41 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:16:41 INFO     [train.py:278] train loss : 4.593214361563973
2022-11-17:13:16:41 DEBUG    [train.py:203]  preds : tensor([[ 1,  1],
        [ 7,  1],
        [ 9, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63],
        [ 7, 63]], device='cuda:0')
2022-11-17:13:16:41 DEBUG    [train.py:204] labels : tensor([[ 1,  1],
        [ 7, 63],
        [ 9, 39],
        [ 7, 44],
        [ 4, 44],
        [ 7, 33],
        [10, 33],
        [ 7, 63],
        [ 9, 44],
        [ 7, 55],
        [ 5, 44],
        [ 7, 33],
        [10, 33],
        [ 2,  2]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:16:41 DEBUG    [train.py:205]     em : tensor([[1, 1],
        [1, 0],
        [1, 0],
        [1, 0],
        [0, 0],
        [1, 0],
        [0, 0],
        [1, 1],
        [0, 0],
        [1, 0],
        [0, 0],
        [1, 0],
        [0, 0],
        [0, 0]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:16:41 DEBUG    [train.py:206]  pairs : tensor([1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], device='cuda:0',
       dtype=torch.int32)
2022-11-17:13:16:41 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:16:41 INFO     [train.py:294] val loss : 4.4642261664072675 | val acc: (exact: 0.0 | pairwise: 0.02013217820171758 | tokens: 0.29456299764932775)
2022-11-17:13:16:49 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:16:49 INFO     [train.py:278] train loss : 3.462087095647618
2022-11-17:13:16:58 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:16:58 INFO     [train.py:278] train loss : 2.9776884973913
2022-11-17:13:17:05 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:17:05 INFO     [train.py:278] train loss : 2.6302421663118447
2022-11-17:13:17:14 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:17:14 INFO     [train.py:278] train loss : 2.3583313740681913
2022-11-17:13:17:24 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:17:24 INFO     [train.py:278] train loss : 2.003570346728615
2022-11-17:13:17:24 DEBUG    [train.py:203]  preds : tensor([[ 1,  1],
        [ 7, 63],
        [ 9, 67],
        [ 7, 33],
        [10, 44],
        [ 7,  2],
        [10, 63],
        [ 2,  2],
        [ 0,  0],
        [ 0,  0]], device='cuda:0')
2022-11-17:13:17:24 DEBUG    [train.py:204] labels : tensor([[ 1,  1],
        [ 7, 58],
        [ 9, 27],
        [ 7, 63],
        [10, 63],
        [ 7, 58],
        [ 9, 27],
        [ 7, 63],
        [10, 63],
        [ 2,  2]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:17:24 DEBUG    [train.py:205]     em : tensor([[1, 1],
        [1, 0],
        [1, 0],
        [1, 0],
        [1, 0],
        [1, 0],
        [0, 0],
        [0, 0],
        [0, 0],
        [0, 0]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:17:24 DEBUG    [train.py:206]  pairs : tensor([1, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0', dtype=torch.int32)
2022-11-17:13:17:24 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:17:24 INFO     [train.py:294] val loss : 4.081516702969869 | val acc: (exact: 0.0 | pairwise: 0.11495266031983087 | tokens: 0.4118134881809747)
2022-11-17:13:17:33 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:17:33 INFO     [train.py:278] train loss : 2.1575008905020314
2022-11-17:13:17:42 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:17:42 INFO     [train.py:278] train loss : 2.047873812093251
2022-11-17:13:17:51 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:17:51 INFO     [train.py:278] train loss : 2.326625563096309
2022-11-17:13:18:01 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:18:01 INFO     [train.py:278] train loss : 2.2680645511634108
2022-11-17:13:18:11 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:18:11 INFO     [train.py:278] train loss : 1.9711242998423784
2022-11-17:13:18:11 DEBUG    [train.py:203]  preds : tensor([[ 1,  1],
        [ 7, 38],
        [ 9, 41],
        [ 7, 45],
        [ 6, 45],
        [ 2,  2],
        [ 2,  2],
        [ 2,  2],
        [ 2,  2],
        [ 2,  2]], device='cuda:0')
2022-11-17:13:18:11 DEBUG    [train.py:204] labels : tensor([[ 1,  1],
        [ 7, 66],
        [ 9,  9],
        [ 7, 78],
        [10, 78],
        [ 7,  6],
        [ 9,  9],
        [ 7, 78],
        [10, 78],
        [ 2,  2]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:18:11 DEBUG    [train.py:205]     em : tensor([[1, 1],
        [1, 0],
        [1, 0],
        [1, 0],
        [0, 0],
        [0, 0],
        [0, 0],
        [0, 0],
        [0, 0],
        [1, 1]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:18:11 DEBUG    [train.py:206]  pairs : tensor([1, 0, 0, 0, 0, 0, 0, 0, 0, 1], device='cuda:0', dtype=torch.int32)
2022-11-17:13:18:12 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:18:12 INFO     [train.py:294] val loss : 3.5323822498321533 | val acc: (exact: 0.0 | pairwise: 0.17294008919089246 | tokens: 0.47046974705134653)
2022-11-17:13:18:22 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:18:22 INFO     [train.py:278] train loss : 1.6726574140830317
2022-11-17:13:18:32 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:18:32 INFO     [train.py:278] train loss : 1.497589904329051
2022-11-17:13:18:42 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:18:42 INFO     [train.py:278] train loss : 1.6773331474134887
2022-11-17:13:18:50 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:18:50 INFO     [train.py:278] train loss : 1.7554977674415146
2022-11-17:13:19:01 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:01 INFO     [train.py:278] train loss : 1.5838955086858377
2022-11-17:13:19:01 DEBUG    [train.py:203]  preds : tensor([[ 1,  1],
        [ 7, 63],
        [ 9, 62],
        [ 7, 33],
        [10, 53],
        [ 7,  2]], device='cuda:0')
2022-11-17:13:19:01 DEBUG    [train.py:204] labels : tensor([[ 1,  1],
        [ 7, 59],
        [ 9, 29],
        [ 7, 43],
        [10, 43],
        [ 2,  2]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:19:01 DEBUG    [train.py:205]     em : tensor([[1, 1],
        [1, 0],
        [1, 0],
        [1, 0],
        [1, 0],
        [0, 1]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:19:01 DEBUG    [train.py:206]  pairs : tensor([1, 0, 0, 0, 0, 0], device='cuda:0', dtype=torch.int32)
2022-11-17:13:19:01 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:01 INFO     [train.py:294] val loss : 3.0782180229822793 | val acc: (exact: 0.0 | pairwise: 0.2299948029166503 | tokens: 0.5286975457942743)
2022-11-17:13:19:09 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:09 INFO     [train.py:278] train loss : 1.4809618484822735
2022-11-17:13:19:17 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:17 INFO     [train.py:278] train loss : 1.6238390074475952
2022-11-17:13:19:25 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:25 INFO     [train.py:278] train loss : 1.4359939384503642
2022-11-17:13:19:34 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:34 INFO     [train.py:278] train loss : 1.502725253664497
2022-11-17:13:19:42 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:42 INFO     [train.py:278] train loss : 1.367958920751361
2022-11-17:13:19:42 DEBUG    [train.py:203]  preds : tensor([[ 1,  1],
        [ 7, 66],
        [ 9,  3],
        [ 7, 19],
        [10, 19],
        [ 2,  2]], device='cuda:0')
2022-11-17:13:19:42 DEBUG    [train.py:204] labels : tensor([[ 1,  1],
        [ 7, 12],
        [ 9, 73],
        [ 7, 19],
        [ 6, 19],
        [ 2,  2]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:19:42 DEBUG    [train.py:205]     em : tensor([[1, 1],
        [1, 0],
        [1, 0],
        [1, 1],
        [0, 1],
        [1, 1]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:19:42 DEBUG    [train.py:206]  pairs : tensor([1, 0, 0, 1, 0, 1], device='cuda:0', dtype=torch.int32)
2022-11-17:13:19:42 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:42 INFO     [train.py:294] val loss : 2.8679333130518594 | val acc: (exact: 0.0 | pairwise: 0.24891904189432268 | tokens: 0.5437452174919687)
2022-11-17:13:19:50 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:50 INFO     [train.py:278] train loss : 1.1979101920041486
2022-11-17:13:19:58 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:19:58 INFO     [train.py:278] train loss : 1.1420880816336991
2022-11-17:13:20:06 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:20:06 INFO     [train.py:278] train loss : 1.2919660734579614
2022-11-17:13:20:15 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:20:15 INFO     [train.py:278] train loss : 1.3589240726407454
2022-11-17:13:20:23 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:20:23 INFO     [train.py:278] train loss : 1.4376770459871362
2022-11-17:13:20:23 DEBUG    [train.py:203]  preds : tensor([[ 1,  1],
        [ 7, 78],
        [ 9, 37],
        [ 7, 45],
        [ 6, 45],
        [ 2,  2]], device='cuda:0')
2022-11-17:13:20:23 DEBUG    [train.py:204] labels : tensor([[ 1,  1],
        [ 7, 43],
        [ 9,  5],
        [ 7, 45],
        [ 6, 45],
        [ 2,  2]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:20:23 DEBUG    [train.py:205]     em : tensor([[1, 1],
        [1, 0],
        [1, 0],
        [1, 1],
        [1, 1],
        [1, 1]], device='cuda:0', dtype=torch.int32)
2022-11-17:13:20:23 DEBUG    [train.py:206]  pairs : tensor([1, 0, 0, 1, 1, 1], device='cuda:0', dtype=torch.int32)
2022-11-17:13:20:23 DEBUG    [train.py:226] calculating epoch loss...
2022-11-17:13:20:23 INFO     [train.py:294] val loss : 2.668749769528707 | val acc: (exact: 0.0022271245503597123 | pairwise: 0.29899460949200235 | tokens: 0.5729554393451562)
